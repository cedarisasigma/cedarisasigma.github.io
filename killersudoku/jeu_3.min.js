var startTime=0,start=0,end=0,diff=0,timerID=0,traces=new Array,coup=0,selectionId=0,chiffres="0123456789",alphabet="abcdefghijklmnopqrstuvwxyz",grille=jeu.split(""),sudoku=jeu.split(""),autoSelect,forceSuppr=0,storage=function(){var uid=new Date,result;try{return localStorage.setItem(uid,uid),result=localStorage.getItem(uid)==uid,localStorage.removeItem(uid),result&&localStorage}catch(e){}}(),mode=$_("input[type=radio][name=mode]:checked")[0].getAttribute("value"),verif=$_("input[type=radio][name=verif]:checked")[0].getAttribute("value"),surLigne=$("surLigne").classList.contains("on");function recup_auto_select(){autoSelect=$("autoSelect").classList.contains("on")?"mouseover":"click"}function $(id){return document.getElementById(id)}function $_(a,b){return void 0!==b?b.querySelectorAll(a):document.querySelectorAll(a)}var fauxClick=0;function declanche_action(el,etype){if("click"==etype&&(fauxClick=1),el.fireEvent)el.fireEvent("on"+etype);else{var evObj=document.createEvent("Events");evObj.initEvent(etype,!0,!1),el.dispatchEvent(evObj)}}function declanche_touche(el,key){var eventObj;if(document.createEventObject)(eventObj=document.createEventObject()).keyCode=key,el.fireEvent("onkeydown",eventObj),eventObj.keyCode=key;else if(document.createEvent){var eventObj;(eventObj=document.createEvent("Events")).initEvent("keydown",!0,!0),eventObj.which=key,eventObj.keyCode=key,el.dispatchEvent(eventObj)}}function format_valeur_case_multi(str){let tabTouche=listeTouches.split(""),htmlCaseMulti='<div class="mini">';for(i=0;i<tabTouche.length;i++)-1==str.indexOf(tabTouche[i])?htmlCaseMulti+='<div class="minival m_'+i+'"></div>':htmlCaseMulti+='<div class="minival m_'+i+'"><p>'+tabTouche[i]+"</p></div>";return htmlCaseMulti+="</div>",htmlCaseMulti}function linearise(sudoku){return sudoku.join("|")}function valider_touche(touche){let listeTouches2;return-1!=(listeTouches+"0 ").indexOf(touche)||"SPACEBAR"==touche||"DEL"==touche||"DELETE"==touche||"BACKSPACE"==touche}function vider_case(idCase){sudoku[idCase]=0,$("c_"+idCase).innerHTML="",$("c_"+idCase).removeAttribute("v")}function ajouter_valeur_case(idCase,valeur){let oCase=$("c_"+idCase);if("valeur"==mode)sudoku[idCase]=valeur,oCase.setAttribute("v",valeur),oCase.innerHTML="<p>"+valeur+"</p>",$("p_"+valeur).classList.add("pad_on");else if("mixte"==mode&&0==sudoku[idCase])sudoku[idCase]=valeur,oCase.setAttribute("v",valeur),oCase.innerHTML="<p>"+valeur+"</p>";else{let tab=new Array;oCase.removeAttribute("v"),0==sudoku[idCase]?tab.push("."):tab=sudoku[idCase].split(""),"."!=tab[0]&&tab.push("."),tab.push(valeur),tab.sort(),sudoku[idCase]=tab.join(""),oCase.innerHTML=format_valeur_case_multi(sudoku[idCase]),oCase.classList.add("multi")}}function supprimer_valeur_case(idCase,valeur){let oCase=$("c_"+idCase);if("valeur"==mode||1==sudoku[idCase].toString().length||2==sudoku[idCase].length)vider_case(idCase);else{let tab=sudoku[idCase].split(valeur);sudoku[idCase]=tab.join(""),"mixte"==mode&&2==sudoku[idCase].length?(oCase.classList.remove("multi"),sudoku[idCase]=sudoku[idCase].substr(1,1),oCase.setAttribute("v",sudoku[idCase]),oCase.innerHTML="<p>"+sudoku[idCase]+"</p>"):oCase.innerHTML=format_valeur_case_multi(sudoku[idCase])}}function sauvegarder(numSudoku,sudoku){if(coup++,traces[coup]=linearise(sudoku),test_retour_restaure(),sauvegarde_locale(numSudoku,sudoku),1==coup){let date=new Date(Date.now()+2592e6).toUTCString();document.cookie="numSudoku="+numSudoku+"; path=/; expires="+date}}function sauvegarde_locale(numSudoku,sudoku){storage&&(localStorage.setItem("numSudoku",numSudoku),localStorage.setItem("sudoku",linearise(sudoku)),localStorage.setItem("coup",coup),localStorage.setItem("traces",JSON.stringify(traces)),localStorage.setItem("diff",diff))}function sauvegarde_locale_chrono(diff){storage&&localStorage.setItem("diff",diff)}function sauvegarde_locale_mode(mode){storage&&localStorage.setItem("mode",mode)}function sauvegarde_locale_verif(verif){storage&&localStorage.setItem("verif",verif)}function sauvegarde_locale_check(nom,val){storage&&localStorage.setItem(nom,val)}function suppr_sauvegarde_locale(){if(storage){localStorage.removeItem("numSudoku"),localStorage.removeItem("sudoku"),localStorage.removeItem("traces"),localStorage.removeItem("coup"),localStorage.removeItem("diff");let date=new Date(Date.now()-1e3).toUTCString();document.cookie="numSudoku=; path=/; expires="+date}}function charger(sudoku){for(id=0;id<sudoku.length;id++){var oCase=$("c_"+id);oCase.classList.contains("fixe")||(0==sudoku[id]?(oCase.innerHTML="",oCase.removeAttribute("v")):1==sudoku[id].toString().length?(oCase.classList.remove("multi"),oCase.setAttribute("v",sudoku[id]),oCase.innerHTML="<p>"+sudoku[id]+"</p>"):(oCase.innerHTML=format_valeur_case_multi(sudoku[id]),oCase.classList.add("multi"),oCase.removeAttribute("v")))}}function valeurs_impossibles_killer(idCase){let val=listeTouches,oCase=$("c_"+idCase),l=oCase.getAttribute("l"),c=oCase.getAttribute("c"),r=oCase.getAttribute("r"),r2=oCase.getAttribute("r2"),o_r2=$_("#grilleJeu div[r2='"+r2+"']"),nbr2=o_r2.length,somme=$_("#grilleJeu div[r2='"+r2+"'][data-somme]")[0].getAttribute("data-somme");if(1==nbr2)return val.replace(somme,"");let part=eval("p_"+somme+"_"+nbr2);part=part.split(" ");let part2=Object.create(part);if($_("#grilleJeu div[r2='"+r2+"'][r='"+r+"']").length==nbr2){let o_r=$_("#grilleJeu div[r='"+r+"'][v]:not([r2='"+r2+"'])");if(0!=o_r.length)for(var i=0;i<o_r.length;i++)part.forEach((function(item){-1!=item.indexOf(o_r[i].getAttribute("v"))&&-1!=part2.indexOf(item)&&part2.splice(part2.indexOf(item),1)}))}if($_("#grilleJeu div[r2='"+r2+"'][l='"+l+"']").length==nbr2){let o_l=$_("#grilleJeu div[l='"+l+"'][v]:not([r2='"+r2+"']");if(0!=o_l.length)for(var i=0;i<o_l.length;i++)part.forEach((function(item){-1!=item.indexOf(o_l[i].getAttribute("v"))&&-1!=part2.indexOf(item)&&part2.splice(part2.indexOf(item),1)}))}if($_("#grilleJeu div[r2='"+r2+"'][c='"+c+"']").length==nbr2){let o_c=$_("#grilleJeu div[c='"+c+"'][v]:not([r2='"+r2+"']");if(0!=o_c.length)for(var i=0;i<o_c.length;i++)part.forEach((function(item){-1!=item.indexOf(o_c[i].getAttribute("v"))&&-1!=part2.indexOf(item)&&part2.splice(part2.indexOf(item),1)}))}let o_r2_v=$_("#grilleJeu div[r2='"+r2+"'][v]");if(0!=o_r2_v.length)for(var i=0;i<o_r2_v.length;i++){let part3=new Array;part2.forEach((function(item){-1!=item.indexOf(o_r2_v[i].getAttribute("v"))&&part3.push(item.replace(o_r2_v[i].getAttribute("v"),""))})),part2=part3}let valok=part2.join("").split("");return valok.filter((function(item,index){return valok.indexOf(item)===index})),valok.forEach((function(item){val=val.replace(item,"")})),val}function valeurs_possibles(idCase){let val=listeTouches,oCase=$("c_"+idCase),l=oCase.getAttribute("l"),c=oCase.getAttribute("c"),r=oCase.getAttribute("r");if("9x9-killer"==type){let valimpos=valeurs_impossibles_killer(idCase);if(valimpos)for(var i=0;i<valimpos.length;i++)val=val.replace(valimpos[i],"")}let o_l=$_("#grilleJeu div[l='"+l+"'][v]:not([c='"+c+"'])");if(0!=o_l.length)for(var i=0;i<o_l.length;i++)val=val.replace(o_l[i].getAttribute("v"),"");let o_c=$_("#grilleJeu div[c='"+c+"'][v]:not([l='"+l+"'])");if(0!=o_c.length)for(var i=0;i<o_c.length;i++)val=val.replace(o_c[i].getAttribute("v"),"");let o_r=$_("#grilleJeu div[r='"+r+"'][v]:not([l='"+l+"'])");if(0!=o_r.length)for(var i=0;i<o_r.length;i++)val=val.replace(o_r[i].getAttribute("v"),"");return val}function verification(idCase){let oCase=$("c_"+idCase);if(oCase.classList.remove("err"),"verifNo"!=verif&&null!=oCase.getAttribute("v")){let v=oCase.getAttribute("v"),l=oCase.getAttribute("l"),c=oCase.getAttribute("c"),r=oCase.getAttribute("r"),o_l=$_("#grilleJeu div[l='"+l+"'][v='"+v+"']:not([c='"+c+"'])");0!=o_l.length&&(o_l[0].classList.add("err_impos"),oCase.classList.add("err"),oCase.classList.add("err_impos"));let o_c=$_("#grilleJeu div[c='"+c+"'][v='"+v+"']:not([l='"+l+"'])");0!=o_c.length&&(o_c[0].classList.add("err_impos"),oCase.classList.add("err"),oCase.classList.add("err_impos"));let o_r=$_("#grilleJeu div[r='"+r+"'][v='"+v+"']:not([l='"+l+"'])");0!=o_r.length&&(o_r[0].classList.add("err_impos"),oCase.classList.add("err"),oCase.classList.add("err_impos"))}"verifAll"==verif&&null!=oCase.getAttribute("v")&&oCase.getAttribute("v")!=sol[idCase]&&oCase.classList.add("err")}function verification_grille(){if(remove_class($_("#grilleJeu .err_impos"),"err_impos"),!$("jeu").classList.contains("solution")){if(linearise(sudoku)==linearise(sol)){if(clearTimeout(timerID),$("rappelChrono").textContent=$("chronotime").textContent,gagner(),alpha=alphabet+chiffres+alphabet.toUpperCase(),"9x9"==type)var idg=numSudoku,idt="9";else if("9x9-lettres"==type)var idg=numSudoku.substring(1).split("-")[0],idt=numSudoku.substring(0,1),idl=numSudoku.substring(1).split("-")[1];else var idg=numSudoku.substring(1),idt=numSudoku.substring(0,1);var ch=co="";for(i=0;i<idg.length;i++)ch>0&&ch<=5?ch+=idg.charAt(i):ch=idg.charAt(i),(0==ch||ch>=6||i==idg.length-1)&&(co+=alpha.charAt(ch));function cti(ti){var c="";return ti.forEach((function(i){c+=alpha.charAt(i)})),c}return ti=$("chronotime").textContent.split(":"),co="_"+idt+alpha.charAt(Math.floor(60*Math.random()))+cti(ti.reverse())+"Y"+co+"Z"+cti(ti.reverse())+alpha.charAt(Math.floor(60*Math.random())),idl&&(co+="-"+idl),$("btnwhatsapp").setAttribute("href",$("btnwhatsapp").getAttribute("href")+co),$("btnfacebook").setAttribute("href",$("btnfacebook").getAttribute("href")+co),$("btntwitter").setAttribute("href",$("btntwitter").getAttribute("href")+co),!0}let o_g=$_("#grilleJeu div[v]:not(.fixe)");for(var i=0;i<o_g.length;i++){let idCase;verification(o_g[i].getAttribute("id").substr(2))}}}function tester_grille(){let o_g=$_("#grilleJeu div[v]:not(.fixe)");for(var i=0;i<o_g.length;i++){let idCase=o_g[i].getAttribute("id").substr(2);if(o_g[i].getAttribute("v")!=sol[idCase])return!1}return!0}function suppr_erreur_grille(){let o_g=$_("#grilleJeu div[v]:not(.fixe)");for(var i=0;i<o_g.length;i++){let idCase=o_g[i].getAttribute("id").substr(2);o_g[i].getAttribute("v")!=sol[idCase]&&vider_case(idCase)}return!0}function gagner(){$("jeu").classList.add("gagne"),remove_all_classe_surligne(),remove_class($_("#pad>div"),"pad_on");let el=$("grille");el.outerHTML=el.outerHTML;let el2=$("startstop");el2.outerHTML=el2.outerHTML;let el3=$("controles");el3.outerHTML=el3.outerHTML,$("pubjeu").classList.remove("cache"),suppr_sauvegarde_locale()}function remove_class(tab,classe){return Array.prototype.slice.call(tab).forEach((function(el){el.classList.remove(classe)}))}function add_class(tab,classe){return Array.prototype.slice.call(tab).forEach((function(el){el.classList.add(classe)}))}function remove_all_classe_surligne_sauf_selection(){remove_class($_("#grilleJeu .nb_select"),"nb_select"),remove_class($_("#grilleJeu .l_select"),"l_select"),remove_class($_("#grilleJeu .c_select"),"c_select"),remove_class($_("#grilleJeu .r_select"),"r_select")}function remove_all_classe_surligne(){remove_all_classe_surligne_sauf_selection(),remove_class($_("#grilleJeu .selection"),"selection")}function remove_all_classe(){remove_all_classe_surligne(),remove_class($_("#grilleJeu .err_impos"),"err_impos")}function menu_pad(idCase){if(remove_class($_("#pad>div"),"pad_on"),0!=sudoku[idCase]){let val=sudoku[idCase].replace(".","");for(var i=0;i<val.length;i++)$("p_"+val[i]).classList.add("pad_on")}}function active(obj){obj.classList.remove("desactive")}function desactive(obj){obj.classList.add("desactive")}function test_retour_restaure(){active($("retour")),active($("restaure")),0==coup&&desactive($("retour")),coup>=traces.length-1&&desactive($("restaure"))}function chrono(){end=new Date,diff=end-start;let sec=(diff=new Date(diff)).getSeconds(),min=diff.getMinutes(),hr=diff.getHours()-1;min<10&&(min="0"+min),sec<10&&(sec="0"+sec),document.getElementById("chronotime").innerHTML=hr>0?hr+":"+min+":"+sec:min+":"+sec,timerID=setTimeout("chrono()",1e3)}function change_chiffre_mode_doubleclicktap(idCase){let oCase=$("c_"+idCase);1!=sudoku[idCase].toString().length||!oCase.hasAttribute("v")||"mixte"!=mode&&"candidat"!=mode?2!=sudoku[idCase].length||"."!=sudoku[idCase].substr(0,1)||!oCase.classList.contains("multi")||"mixte"!=mode&&"valeur"!=mode||(oCase.classList.remove("multi"),sudoku[idCase]=sudoku[idCase].substr(1,1),oCase.setAttribute("v",sudoku[idCase]),oCase.innerHTML="<p>"+sudoku[idCase]+"</p>",sauvegarder(numSudoku,sudoku),verification_grille()):(oCase.removeAttribute("v"),sudoku[idCase]="."+sudoku[idCase],oCase.innerHTML=format_valeur_case_multi(sudoku[idCase]),oCase.classList.add("multi"),sauvegarder(numSudoku,sudoku),verification_grille())}function mea_regions(r){let o_g=$_('#grilleJeu .c[r2="'+r+'"]');for(var i=0;i<o_g.length;i++)o_g[i].classList.add("mea");return!0}function suppr_mea_regions(r){let o_g=$_("#grilleJeu .mea");for(var i=0;i<o_g.length;i++)o_g[i].classList.remove("mea");return!0}function init_jeu(){function selection_case(action){for(var dCase=$_("#grilleJeu .c"),i=0;i<dCase.length;i++){dCase[i].addEventListener(action,(function(){if(remove_class($_("#grilleJeu .selection"),"selection"),surLigne&&(remove_class($_("#grilleJeu .nb_select"),"nb_select"),remove_class($_("#grilleJeu .l_select"),"l_select"),remove_class($_("#grilleJeu .c_select"),"c_select"),remove_class($_("#grilleJeu .r_select"),"r_select")),!$("jeu").classList.contains("solution"))if(remove_class($_("#grilleJeu .mea"),"mea"),"9x9-killer"==type&&mea_regions(this.getAttribute("r2")),this.classList.contains("fixe")){if(remove_class($_("#pad>div"),"pad_on"),this.classList.add("selection"),surLigne){let v;add_class($_("#grilleJeu div[v='"+this.firstChild.firstChild.data+"']"),"nb_select")}}else menu_pad(this.getAttribute("id").substr(2)),this.classList.add("selection"),surLigne&&(null!=this.getAttribute("v")&&(add_class($_("#grilleJeu div[v='"+this.getAttribute("v")+"']"),"nb_select"),"verifNo"!=verif&&verification(this.getAttribute("id").substr(2))),add_class($_("#grilleJeu div[l='"+this.getAttribute("l")+"']"),"l_select"),add_class($_("#grilleJeu div[c='"+this.getAttribute("c")+"']"),"c_select"),add_class($_("#grilleJeu div[r='"+this.getAttribute("r")+"']"),"r_select"))}),!1);var mylatesttap=new Array;dCase[i].addEventListener("click",(function(e){let idCase=this.getAttribute("id").substr(2),now,timesince=(new Date).getTime()-mylatesttap[idCase];timesince<300&&timesince>0&&1!=fauxClick&&!this.classList.contains("fixe")&&change_chiffre_mode_doubleclicktap(idCase),mylatesttap[idCase]=(new Date).getTime(),fauxClick=0}),!1)}}for(var fMode=$_("input[type=radio][name=mode]"),i=0;i<fMode.length;i++)fMode[i].addEventListener("change",(function(){sauvegarde_locale_mode(mode=this.value)}));for(var fVerif=$_("input[type=radio][name=verif]"),i=0;i<fVerif.length;i++)fVerif[i].addEventListener("change",(function(){verif=this.value,verification_grille(),sauvegarde_locale_verif(verif)}));$("surLigne").addEventListener("click",(function(){this.classList.toggle("on"),sauvegarde_locale_check("surLigne",surLigne=$("surLigne").classList.contains("on")),surLigne||remove_all_classe_surligne_sauf_selection(),null!=$_("#grilleJeu .selection")[0]&&declanche_action($_("#grilleJeu .selection")[0],"click")})),recup_auto_select(),selection_case(autoSelect),$("autoSelect").addEventListener("click",(function(){if(!this.classList.contains("desactive")){this.classList.toggle("on");let el=$("grilleJeu");el.outerHTML=el.outerHTML,recup_auto_select(),selection_case(autoSelect),sauvegarde_locale_check("autoSelect",autoSelect)}})),$("retour").addEventListener("click",(function(){if(!$("jeu").classList.contains("solution")&&!$("jeu").classList.contains("pause")){if(!(coup>0))return!1;coup--,charger(sudoku=traces[coup].split("|")),sauvegarde_locale(numSudoku,sudoku),verification_grille(),0!=$_("#grilleJeu .selection:not(.fixe)").length&&menu_pad($_("#grilleJeu .selection:not(.fixe)")[0].getAttribute("id").substr(2)),0==coup&&linearise(sudoku)==linearise(grille)&&suppr_sauvegarde_locale(),test_retour_restaure()}})),$("restaure").addEventListener("click",(function(){if(!$("jeu").classList.contains("solution")&&!$("jeu").classList.contains("pause")){if(!(coup<traces.length-1))return!1;coup++,charger(sudoku=traces[coup].split("|")),sauvegarde_locale(numSudoku,sudoku),verification_grille(),0!=$_("#grilleJeu .selection:not(.fixe)").length&&menu_pad($_("#grilleJeu .selection:not(.fixe)")[0].getAttribute("id").substr(2)),test_retour_restaure()}})),$("nouvellePartie").addEventListener("click",(function(){suppr_sauvegarde_locale()})),$("effacerGrille").addEventListener("click",(function(){charger(sudoku=linearise(grille).split("|")),(traces=[])[coup=0]=linearise(sudoku),test_retour_restaure(),suppr_sauvegarde_locale(),test_retour_restaure(),remove_all_classe(),remove_class($_("#pad>div"),"pad_on"),$("voirSolution").classList.remove("on"),$("jeu").classList.remove("solution"),clearTimeout(timerID),diff=new Date(0),$("chronotime").innerHTML="00:00",start=new Date,chrono(),$("lightbox_new_game").classList.add("cache")})),$("affCandidats").addEventListener("click",(function(e){if(!$("jeu").classList.contains("solution")&&!$("jeu").classList.contains("pause"))if(1==forceSuppr&&(suppr_erreur_grille(),verification_grille(),forceSuppr=0),tester_grille()){let o_g=$_("#grilleJeu div[id^='c_']:not([v])");for(var i=0;i<o_g.length;i++){let idCase=o_g[i].getAttribute("id").substr(2),val=valeurs_possibles(idCase);""!=val&&(sudoku[idCase]="."+val)}charger(sudoku),sauvegarder(numSudoku,sudoku)}else e.stopPropagation(),$("lightbox_erreur").classList.remove("cache");return!1})),window.addEventListener("keydown",(function(e){var sel=$_("#grilleJeu .selection");if(0!=sel.length){let touche=e.key,listeTouches3=listeTouches+"0";null==touche&&-1!=listeTouches3.indexOf(e.keyCode)&&(touche=e.keyCode),touche=touche.toUpperCase();let idCase=parseInt(sel[0].getAttribute("id").substr(2));if("click"==autoSelect&&("UP"==touche||"ARROWUP"==touche||"RIGHT"==touche||"ARROWRIGHT"==touche||"DOWN"==touche||"ARROWDOWN"==touche||"LEFT"==touche||"ARROWLEFT"==touche)){e.preventDefault();let l=sel[0].getAttribute("l"),c=sel[0].getAttribute("c");"UP"!=touche&&"ARROWUP"!=touche||l>1&&declanche_action($_('#grilleJeu div[l="'+(l-1)+'"][c="'+c+'"]')[0],"click"),"RIGHT"!=touche&&"ARROWRIGHT"!=touche||c<nbColones&&declanche_action($_('#grilleJeu div[c="'+(parseInt(c)+1)+'"][l="'+l+'"]')[0],"click"),"DOWN"!=touche&&"ARROWDOWN"!=touche||l<nbLignes&&declanche_action($_('#grilleJeu div[l="'+(parseInt(l)+1)+'"][c="'+c+'"]')[0],"click"),"LEFT"!=touche&&"ARROWLEFT"!=touche||c>1&&declanche_action($_('#grilleJeu div[l="'+l+'"][c="'+(c-1)+'"]')[0],"click")}if(sel[0].classList.contains("fixe"))return!0;if(0==touche||" "==touche||"SPACEBAR"==touche||"DEL"==touche||"DELETE"==touche||"BACKSPACE"==touche)e.preventDefault(),vider_case(idCase);else{if(!1===valider_touche(touche))return!0;-1==sudoku[idCase].toString().indexOf(touche)?ajouter_valeur_case(idCase,touche):sel[0].classList.contains("multi")&&"valeur"==mode?ajouter_valeur_case(idCase,touche):supprimer_valeur_case(idCase,touche)}sauvegarder(numSudoku,sudoku),declanche_action(sel[0],autoSelect),verification_grille(),traces.length>coup+1&&(traces.splice(coup+1),test_retour_restaure())}}),!0);for(var oPad=$_("#pad>div"),i=0;i<oPad.length;i++)oPad[i].addEventListener("click",(function(){if(0!=$_("#grilleJeu .selection").length){let n=this.getAttribute("p");declanche_touche($_("#grilleJeu .selection")[0],n)}}));$("gomme").addEventListener("click",(function(){0!=$_("#grilleJeu .selection").length&&declanche_touche($_("#grilleJeu .selection")[0],"0")})),document.getElementById("startstop").addEventListener("click",(function(){return $("jeu").classList.contains("solution")||("start"==this.getAttribute("data-action")?(this.setAttribute("data-action","stop"),this.classList.remove("icofont-play-alt-1"),this.classList.add("icofont-pause"),start=new Date-diff,start=new Date(start),chrono(),$("jeu").classList.remove("pause"),0!=selectionId&&(declanche_action($(selectionId),"click"),selectionId=0)):(this.setAttribute("data-action","start"),this.classList.remove("icofont-pause"),this.classList.add("icofont-play-alt-1"),clearTimeout(timerID),$("jeu").classList.add("pause"),null!=$_("#grilleJeu .selection")[0]&&(selectionId=$_("#grilleJeu .selection")[0].getAttribute("id")),remove_all_classe_surligne(),remove_class($_("#pad>div"),"pad_on"))),!0})),document.getElementById("pause").addEventListener("click",(function(){return declanche_action($("startstop"),"click"),!0})),document.getElementById("gagne").addEventListener("click",(function(){return $("jeu").classList.remove("gagne"),!0})),$("voirSolution").addEventListener("click",(function(){return $("jeu").classList.contains("pause")||(this.classList.toggle("on"),$("jeu").classList.contains("solution")?($("jeu").classList.remove("solution"),charger(sudoku=traces[coup].split("|")),verification_grille()):($("jeu").classList.add("solution"),remove_all_classe_surligne(),remove_class($_("#pad>div"),"pad_on"),charger(sudoku=linearise(sol).split("|")))),!1})),$("new_game").addEventListener("click",(function(e){e.stopPropagation(),$("lightbox_new_game").classList.toggle("cache")})),$("val_niveau").addEventListener("click",(function(e){e.stopPropagation(),$("lightbox_val_niveau").classList.toggle("cache")})),$("btn_pub").addEventListener("click",(function(e){e.stopPropagation(),$("lightbox_btn_pub").classList.toggle("cache")})),$("ouiAffCandidats").addEventListener("click",(function(e){e.stopPropagation(),$("lightbox_erreur").classList.add("cache"),forceSuppr=1,declanche_action($("affCandidats"),"click")})),$("nonAffCandidats").addEventListener("click",(function(e){e.stopPropagation(),$("lightbox_erreur").classList.add("cache")})),$("ouiReprendrePartie").addEventListener("click",(function(e){e.stopPropagation(),storage&&localStorage.getItem("numSudoku")&&(window.location.href=site+"r?n="+localStorage.getItem("numSudoku"))})),$("nonReprendrePartie").addEventListener("click",(function(e){e.stopPropagation(),$("lightbox_partie_en_cours").classList.add("cache"),declanche_action($("startstop"),"click"),suppr_sauvegarde_locale()})),window.addEventListener("click",(function(e){$("lightbox_new_game").contains(e.target)||$("lightbox_new_game").classList.contains("cache")||$("lightbox_new_game").classList.add("cache"),$("lightbox_val_niveau").contains(e.target)||$("lightbox_val_niveau").classList.contains("cache")||$("lightbox_val_niveau").classList.add("cache"),$("lightbox_btn_pub").contains(e.target)||$("lightbox_btn_pub").classList.contains("cache")||$("lightbox_btn_pub").classList.add("cache"),$("lightbox_erreur").contains(e.target)||$("lightbox_erreur").classList.contains("cache")||$("lightbox_erreur").classList.add("cache"),$("lightbox_partie_en_cours").contains(e.target)||$("lightbox_partie_en_cours").classList.contains("cache")||$("lightbox_partie_en_cours").classList.add("cache"),e.stopPropagation()})),$("deasactiv_pub").addEventListener("click",(function(e){e.stopPropagation(),$("pubjeu").classList.toggle("cache")})),window.addEventListener("blur",(function(e){$("jeu").classList.contains("pause")||declanche_action($("startstop"),"click")}),!1),window.addEventListener("unload",(function(e){coup>=1&&!$("jeu").classList.contains("gagne")&&sauvegarde_locale_chrono(diff)}))}function cb2b(numberInput,fromBaseInput,toBaseInput){if(fromBaseInput==toBaseInput)return numberInput;let fromBase=fromBaseInput.split(""),toBase=toBaseInput.split(""),number=numberInput.split(""),fromLen=fromBaseInput.length,toLen=toBaseInput.length,numberLen=numberInput.length,retval="";if("0123456789"==toBaseInput){retval=0;for(let i=1;i<=numberLen;i++)retval+=fromBase.indexOf(number[i-1])*Math.pow(fromLen,numberLen-i);return retval}if(base10="0123456789"!=fromBaseInput?cb2b(numberInput,fromBaseInput,"0123456789"):numberInput,base10<toBaseInput.length)return toBase[base10];for(;"0"!=base10;)retval=toBase[base10%toLen]+retval,base10=(base10-base10%toLen)/toLen;return retval}function decr(c){let map=alphabet+chiffres+alphabet.toUpperCase()+caracteres,sol=c.split("|"),b="0"+listeTouches,result="";for(var i=0;i<sol.length;i++)result+=cb2b(sol[i],map,b);return result}!function(){var numS;if(sol=decr(clef).split(""),storage&&localStorage.getItem("numSudoku"))if(localStorage.getItem("numSudoku")==numSudoku)sudoku=localStorage.getItem("sudoku").split("|"),traces=JSON.parse(localStorage.getItem("traces")),coup=localStorage.getItem("coup"),charger(sudoku),traces[coup]=linearise(sudoku),diff=Date.parse(localStorage.getItem("diff")),start=new Date-diff,start=new Date(start);else{var partieEnCours=!0;start=new Date,charger(sudoku),traces[coup]=linearise(sudoku)}else start=new Date,charger(sudoku),traces[coup]=linearise(sudoku);storage&&localStorage.getItem("mode")&&(mode=localStorage.getItem("mode"),document.getElementById(mode).checked=!0),storage&&localStorage.getItem("verif")&&(verif=localStorage.getItem("verif"),document.getElementById(verif).checked=!0),storage&&localStorage.getItem("surLigne")&&((surLigne="true"==localStorage.getItem("surLigne"))?$("surLigne").classList.add("on"):$("surLigne").classList.remove("on")),storage&&localStorage.getItem("autoSelect")&&("mouseover"!=(autoSelect=localStorage.getItem("autoSelect"))||$("autoSelect").classList.contains("desactive")?$("autoSelect").classList.remove("on"):$("autoSelect").classList.add("on")),chrono(),test_retour_restaure(),verification_grille(),init_jeu(),"undefined"!=typeof affsol&&affsol&&declanche_action($("voirSolution"),"click"),partieEnCours&&(declanche_action($("startstop"),"click"),$("lightbox_partie_en_cours").classList.remove("cache"))}();