<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>EmulatorJS</title>
    <link
      rel="icon"
      href="https://Eminence5070.github.io/apps/emulatorjs
      /docs/favicon.ico"
      sizes="16x16 32x32 48x48 64x64"
      type="image/vnd.microsoft.icon"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      /* Your styles remain the same */
      body, html {
        height: 100%;
        background-color: black;
        color: white;
        margin: 0;
        overflow: hidden;
      }
      body, #box, #top {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
      }
      #box {
        color: #aaa;
        height: 20em;
        width: 30em;
        max-width: 80%;
        max-height: 80%;
        background-color: #333;
        border-radius: 0.4em;
        border: 2px solid #555;
        position: relative;
        transition-duration: 0.2s;
        overflow: hidden;
        font-family: monospace;
        font-weight: bold;
        font-size: 20px;
        margin: 5px;
      }
      #box:hover, #box[drag] {
        border-color: #38f;
        color: #ddd;
      }
      #input {
        cursor: pointer;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
      }
      #display {
        width: 100%;
        height: 100%;
      }
      select, button {
        padding: 0.6em 0.4em;
        margin: 0.5em;
        width: 15em;
        max-width: 100%;
        font-family: monospace;
        font-weight: bold;
        font-size: 16px;
        background-color: #444;
        color: #aaa;
        border-radius: 0.4em;
        border: 1px solid #555;
        cursor: pointer;
        transition-duration: 0.2s;
      }
      select:hover, button:hover {
        background-color: #666;
        color: #ddd;
      }
      .logo {
        width: 130px;
        height: 130px;
        filter: drop-shadow(0 0 10px white);
      }
      #top {
        margin: 5px;
      }
    </style>
  </head>

  <body>
    <div id="top">
      <h1>EmulatorJS Demo</h1>
      <img src="https://Eminence5070.github.io/apps/emulatorjs/docs/Logo-light.png" alt="Logo" class="logo" />
    </div>
    <div id="box">
      <input type="file" id="input" />
      Drag ROM file or click here
    </div>

    <script>
      (async function () {
        let enableDebug = false;
        let enableThreads = false;

        const gamefileTag = document.querySelector('gamefile');

        if (gamefileTag && gamefileTag.getAttribute('src')) {
          const gameUrl = gamefileTag.getAttribute('src');
          const parts = gameUrl.split(".");
          const ext = parts.pop().toLowerCase();

          const core = (() => {
            if (["fds", "nes", "unif", "unf"].includes(ext)) return "nes";
            if (["smc", "fig", "sfc", "gd3", "gd7", "dx2", "bsx", "swc"].includes(ext)) return "snes";
            if (["z64", "n64"].includes(ext)) return "n64";
            if (["pce"].includes(ext)) return "pce";
            if (["ngp", "ngc"].includes(ext)) return "ngp";
            if (["ws", "wsc"].includes(ext)) return "ws";
            if (["col", "cv"].includes(ext)) return "coleco";
            if (["d64"].includes(ext)) return "vice_x64sc";
            if (["nds", "gba", "gb"].includes(ext)) return ext;
            return "nes"; // default fallback core
          })();

          const div = document.createElement("div");
          const sub = document.createElement("div");
          const script = document.createElement("script");

          sub.id = "game";
          div.id = "display";

          const top = document.getElementById("top");
          top.remove();
          const box = document.getElementById("box");
          box.remove();
          div.appendChild(sub);
          document.body.appendChild(div);

          const fullGameUrl = gameUrl;

          window.EJS_player = "#game";
          window.EJS_gameName = parts.join(".");
          window.EJS_biosUrl = "";
          window.EJS_gameUrl = fullGameUrl;
          window.EJS_core = core;
          window.EJS_pathtodata = "https://Eminence5070.github.io/apps/emulatorjs/data/";
          window.EJS_startOnLoaded = true;
          window.EJS_DEBUG_XX = enableDebug;
          window.EJS_disableDatabases = true;
          window.EJS_threads = enableThreads;

          script.src = "https://Eminence5070.github.io/apps/emulatorjs/data/loader.js";
          document.body.appendChild(script);

        } else {
          console.error("<gamefile src='...'> not found or missing 'src' attribute.");
        }
      })();
    </script>
  </body>
</html>
